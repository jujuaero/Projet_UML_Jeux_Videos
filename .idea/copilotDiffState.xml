<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/src/main/java/fr/efrei/domain/Game.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/fr/efrei/domain/Game.java" />
              <option name="originalContent" value="package fr.efrei.domain;&#10;&#10;&#10;import java.io.Serializable;&#10;import java.util.Objects;&#10;&#10;public class Game implements Serializable {&#10;    private final String id;&#10;    private final String title;&#10;    private final String genre;&#10;    private final GamePlatform platform;&#10;    private boolean available;&#10;&#10;    private Game(Builder builder) {&#10;        this.id = builder.id;&#10;        this.title = builder.title;&#10;        this.genre = builder.genre;&#10;        this.platform = builder.platform;&#10;        this.available = builder.available;&#10;    }&#10;&#10;    public String getId() { return id; }&#10;    public String getTitle() { return title; }&#10;    public String getGenre() { return genre; }&#10;    public GamePlatform getPlatform() { return platform; }&#10;    public boolean isAvailable() { return available; }&#10;&#10;    public void setAvailable(boolean available) { this.available = available; }&#10;&#10;    public static class Builder {&#10;        private String id;&#10;        private String title;&#10;        private String genre;&#10;        private GamePlatform platform;&#10;        private boolean available = true;&#10;&#10;        public Builder setId(String id) { this.id = id; return this; }&#10;        public Builder setTitle(String title) { this.title = title; return this; }&#10;        public Builder setGenre(String genre) { this.genre = genre; return this; }&#10;        public Builder setPlatform(GamePlatform platform) { this.platform = platform; return this; }&#10;        public Builder setAvailable(boolean available) { this.available = available; return this; }&#10;&#10;        public Game build() { return new Game(this); }&#10;    }&#10;&#10;    @Override&#10;    public boolean equals(Object o) {&#10;        if (this == o) return true;&#10;        if (!(o instanceof Game)) return false;&#10;        Game game = (Game) o;&#10;        return Objects.equals(id, game.id);&#10;    }&#10;&#10;    @Override&#10;    public int hashCode() { return Objects.hash(id); }&#10;&#10;    @Override&#10;    public String toString() {&#10;        return &quot;Game{&quot; +&#10;                &quot;id='&quot; + id + '\\' +&#10;                &quot;, title='&quot; + title + '\\' +&#10;                &quot;, genre='&quot; + genre + '\\' +&#10;                &quot;, platform=&quot; + platform +&#10;                &quot;, available=&quot; + available +&#10;                '}';&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package fr.efrei.domain;&#10;&#10;&#10;import java.io.Serializable;&#10;import java.util.Objects;&#10;&#10;public class Game implements Serializable {&#10;    private final String id;&#10;    private final String title;&#10;    private final String genre;&#10;    private final GamePlatform platform;&#10;    private final GameType type;&#10;    private boolean available;&#10;    private final double price;&#10;&#10;    private Game(Builder builder) {&#10;        this.id = builder.id;&#10;        this.title = builder.title;&#10;        this.genre = builder.genre;&#10;        this.platform = builder.platform;&#10;        this.available = builder.available;&#10;        this.type = builder.type;&#10;        this.price = builder.price;&#10;    }&#10;&#10;    public String getId() { return id; }&#10;    public String getTitle() { return title; }&#10;    public String getGenre() { return genre; }&#10;    public GamePlatform getPlatform() { return platform; }&#10;    public GameType getType() { return type; }&#10;    public boolean isAvailable() { return available; }&#10;    public double getPrice() { return price; }&#10;&#10;    public void setAvailable(boolean available) { this.available = available; }&#10;&#10;    public static class Builder {&#10;        private String id;&#10;        private String title;&#10;        private String genre;&#10;        private GamePlatform platform;&#10;        private boolean available = true;&#10;        private fr.efrei.domain.GameType type = fr.efrei.domain.GameType.RENTAL;&#10;        private double price = 0.0;&#10;&#10;        public Builder setId(String id) { this.id = id; return this; }&#10;        public Builder setTitle(String title) { this.title = title; return this; }&#10;        public Builder setGenre(String genre) { this.genre = genre; return this; }&#10;        public Builder setPlatform(GamePlatform platform) { this.platform = platform; return this; }&#10;        public Builder setAvailable(boolean available) { this.available = available; return this; }&#10;        public Builder setType(fr.efrei.domain.GameType type) { this.type = type; return this; }&#10;        public Builder setPrice(double price) { this.price = price; return this; }&#10;&#10;        public Game build() { return new Game(this); }&#10;    }&#10;&#10;    @Override&#10;    public boolean equals(Object o) {&#10;        if (this == o) return true;&#10;        if (!(o instanceof Game)) return false;&#10;        Game game = (Game) o;&#10;        return Objects.equals(id, game.id);&#10;    }&#10;&#10;    @Override&#10;    public int hashCode() { return Objects.hash(id); }&#10;&#10;    @Override&#10;    public String toString() {&#10;        return &quot;Game{&quot; +&#10;                &quot;id='&quot; + id + '\\' +&#10;                &quot;, title='&quot; + title + '\\' +&#10;                &quot;, genre='&quot; + genre + '\\' +&#10;                &quot;, platform=&quot; + platform +&#10;                &quot;, type=&quot; + type +&#10;                &quot;, available=&quot; + available +&#10;                &quot;, price=&quot; + price +&#10;                '}';&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/fr/efrei/domain/GameType.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/fr/efrei/domain/GameType.java" />
              <option name="updatedContent" value="package fr.efrei.domain;&#10;&#10;public enum GameType {&#10;    RENTAL,&#10;    SALE&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/fr/efrei/factory/GameFactory.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/fr/efrei/factory/GameFactory.java" />
              <option name="originalContent" value="package fr.efrei.factory;&#10;&#10;import fr.efrei.domain.Game;&#10;import fr.efrei.domain.GamePlatform;&#10;import fr.efrei.util.Helper;&#10;&#10;public final class GameFactory {&#10;    private GameFactory() {}&#10;&#10;    public static Game create(String id, String title, String genre) {&#10;        return create(id, title, genre, null);&#10;    }&#10;&#10;    public static Game create(String id, String title, String genre, GamePlatform platform) {&#10;        String finalId = (id == null || id.isBlank()) ? Helper.IdGenerator.uuid() : id;&#10;        validateNotBlank(title, &quot;title&quot;);&#10;        validateNotBlank(genre, &quot;genre&quot;);&#10;&#10;        return new Game.Builder()&#10;                .setId(finalId)&#10;                .setTitle(title.trim())&#10;                .setGenre(genre.trim())&#10;                .setPlatform(platform)&#10;                .setAvailable(true)&#10;                .build();&#10;    }&#10;&#10;    private static void validateNotBlank(String v, String field) {&#10;        if (v == null || v.isBlank())&#10;            throw new IllegalArgumentException(&quot;Invalid &quot; + field + &quot;: required&quot;);&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package fr.efrei.factory;&#10;&#10;import fr.efrei.domain.Game;&#10;import fr.efrei.domain.GamePlatform;&#10;import fr.efrei.util.Helper;&#10;&#10;public final class GameFactory {&#10;    private GameFactory() {}&#10;&#10;    public static Game create(String id, String title, String genre) {&#10;        return create(id, title, genre, null);&#10;    }&#10;&#10;    public static Game create(String id, String title, String genre, GamePlatform platform) {&#10;        String finalId = (id == null || id.isBlank()) ? Helper.IdGenerator.uuid() : id;&#10;        validateNotBlank(title, &quot;title&quot;);&#10;        validateNotBlank(genre, &quot;genre&quot;);&#10;&#10;        return new Game.Builder()&#10;                .setId(finalId)&#10;                .setTitle(title.trim())&#10;                .setGenre(genre.trim())&#10;                .setPlatform(platform)&#10;                .setAvailable(true)&#10;                .build();&#10;    }&#10;&#10;    public static Game create(String id, String title, String genre, GamePlatform platform, boolean available, fr.efrei.domain.GameType type) {&#10;        String finalId = (id == null || id.isBlank()) ? fr.efrei.util.Helper.IdGenerator.uuid() : id;&#10;        validateNotBlank(title, &quot;title&quot;);&#10;        validateNotBlank(genre, &quot;genre&quot;);&#10;        return new Game.Builder()&#10;                .setId(finalId)&#10;                .setTitle(title.trim())&#10;                .setGenre(genre.trim())&#10;                .setPlatform(platform)&#10;                .setAvailable(available)&#10;                .setType(type)&#10;                .build();&#10;    }&#10;&#10;    public static Game create(String id, String title, String genre, GamePlatform platform, boolean available, fr.efrei.domain.GameType type, double price) {&#10;        String finalId = (id == null || id.isBlank()) ? fr.efrei.util.Helper.IdGenerator.uuid() : id;&#10;        validateNotBlank(title, &quot;title&quot;);&#10;        validateNotBlank(genre, &quot;genre&quot;);&#10;        return new Game.Builder()&#10;                .setId(finalId)&#10;                .setTitle(title.trim())&#10;                .setGenre(genre.trim())&#10;                .setPlatform(platform)&#10;                .setAvailable(available)&#10;                .setType(type)&#10;                .setPrice(price)&#10;                .build();&#10;    }&#10;&#10;    private static void validateNotBlank(String v, String field) {&#10;        if (v == null || v.isBlank())&#10;            throw new IllegalArgumentException(&quot;Invalid &quot; + field + &quot;: required&quot;);&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/fr/efrei/repository/GameRepository.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/fr/efrei/repository/GameRepository.java" />
              <option name="originalContent" value="package fr.efrei.repository;&#10;&#10;import fr.efrei.domain.Game;&#10;import fr.efrei.domain.GamePlatform;&#10;import fr.efrei.factory.GameFactory;&#10;import fr.efrei.util.DatabaseConnection;&#10;&#10;import java.sql.*;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;public class GameRepository {&#10;&#10;    private Connection getConnection() {&#10;        return DatabaseConnection.getInstance().getConnection();&#10;    }&#10;&#10;    public Game save(Game game) {&#10;        String sql = &quot;INSERT INTO games (id, title, genre, platform, is_available) VALUES (?, ?, ?, ?, ?) &quot; +&#10;                     &quot;ON DUPLICATE KEY UPDATE title = VALUES(title), genre = VALUES(genre), &quot; +&#10;                     &quot;platform = VALUES(platform), is_available = VALUES(is_available)&quot;;&#10;&#10;        try (PreparedStatement stmt = getConnection().prepareStatement(sql)) {&#10;            stmt.setString(1, game.getId());&#10;            stmt.setString(2, game.getTitle());&#10;            stmt.setString(3, game.getGenre());&#10;            stmt.setString(4, game.getPlatform().name());&#10;            stmt.setBoolean(5, game.isAvailable());&#10;            stmt.executeUpdate();&#10;            return game;&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la sauvegarde du jeu : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;            return null;&#10;        }&#10;    }&#10;&#10;    public Game findById(String id) {&#10;        String sql = &quot;SELECT * FROM games WHERE id = ?&quot;;&#10;&#10;        try (PreparedStatement stmt = getConnection().prepareStatement(sql)) {&#10;            stmt.setString(1, id);&#10;            ResultSet rs = stmt.executeQuery();&#10;&#10;            if (rs.next()) {&#10;                Game game = GameFactory.create(&#10;                    rs.getString(&quot;id&quot;),&#10;                    rs.getString(&quot;title&quot;),&#10;                    rs.getString(&quot;genre&quot;),&#10;                    GamePlatform.valueOf(rs.getString(&quot;platform&quot;))&#10;                );&#10;                game.setAvailable(rs.getBoolean(&quot;is_available&quot;));&#10;                return game;&#10;            }&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la recherche du jeu : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;        }&#10;        return null;&#10;    }&#10;&#10;    public List&lt;Game&gt; findAll() {&#10;        List&lt;Game&gt; games = new ArrayList&lt;&gt;();&#10;        String sql = &quot;SELECT * FROM games&quot;;&#10;&#10;        try (Statement stmt = getConnection().createStatement();&#10;             ResultSet rs = stmt.executeQuery(sql)) {&#10;&#10;            while (rs.next()) {&#10;                Game game = GameFactory.create(&#10;                    rs.getString(&quot;id&quot;),&#10;                    rs.getString(&quot;title&quot;),&#10;                    rs.getString(&quot;genre&quot;),&#10;                    GamePlatform.valueOf(rs.getString(&quot;platform&quot;))&#10;                );&#10;                game.setAvailable(rs.getBoolean(&quot;is_available&quot;));&#10;                games.add(game);&#10;            }&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la récupération des jeux : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;        }&#10;        return games;&#10;    }&#10;&#10;    public List&lt;Game&gt; findAvailableByPlatform(GamePlatform platform) {&#10;        List&lt;Game&gt; games = new ArrayList&lt;&gt;();&#10;        String sql = &quot;SELECT * FROM games WHERE is_available = true&quot;;&#10;&#10;        try (Statement stmt = getConnection().createStatement();&#10;             ResultSet rs = stmt.executeQuery(sql)) {&#10;&#10;            while (rs.next()) {&#10;                GamePlatform gamePlatform = GamePlatform.valueOf(rs.getString(&quot;platform&quot;));&#10;                if (gamePlatform.isCompatibleWith(platform)) {&#10;                    Game game = GameFactory.create(&#10;                        rs.getString(&quot;id&quot;),&#10;                        rs.getString(&quot;title&quot;),&#10;                        rs.getString(&quot;genre&quot;),&#10;                        gamePlatform&#10;                    );&#10;                    game.setAvailable(rs.getBoolean(&quot;is_available&quot;));&#10;                    games.add(game);&#10;                }&#10;            }&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la récupération des jeux : &quot; + e.getMessage());&#10;        }&#10;        return games;&#10;    }&#10;&#10;    public boolean delete(String id) {&#10;        String sql = &quot;DELETE FROM games WHERE id = ?&quot;;&#10;&#10;        try (PreparedStatement stmt = getConnection().prepareStatement(sql)) {&#10;            stmt.setString(1, id);&#10;            return stmt.executeUpdate() &gt; 0;&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la suppression du jeu : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;            return false;&#10;        }&#10;    }&#10;&#10;    public boolean updateAvailability(String gameId, boolean available) {&#10;        String sql = &quot;UPDATE games SET is_available = ? WHERE id = ?&quot;;&#10;&#10;        try (PreparedStatement stmt = getConnection().prepareStatement(sql)) {&#10;            stmt.setBoolean(1, available);&#10;            stmt.setString(2, gameId);&#10;            return stmt.executeUpdate() &gt; 0;&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la mise à jour de la disponibilité : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;            return false;&#10;        }&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package fr.efrei.repository;&#10;&#10;import fr.efrei.domain.Game;&#10;import fr.efrei.domain.GamePlatform;&#10;import fr.efrei.factory.GameFactory;&#10;import fr.efrei.util.DatabaseConnection;&#10;&#10;import java.sql.*;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;public class GameRepository {&#10;&#10;    private Connection getConnection() {&#10;        return DatabaseConnection.getInstance().getConnection();&#10;    }&#10;&#10;    public Game save(Game game) {&#10;        String sql = &quot;INSERT INTO games (id, title, genre, platform, is_available, type, price) VALUES (?, ?, ?, ?, ?, ?, ?) &quot; +&#10;                     &quot;ON DUPLICATE KEY UPDATE title = VALUES(title), genre = VALUES(genre), &quot; +&#10;                     &quot;platform = VALUES(platform), is_available = VALUES(is_available), type = VALUES(type), price = VALUES(price)&quot;;&#10;&#10;        try (PreparedStatement stmt = getConnection().prepareStatement(sql)) {&#10;            stmt.setString(1, game.getId());&#10;            stmt.setString(2, game.getTitle());&#10;            stmt.setString(3, game.getGenre());&#10;            stmt.setString(4, game.getPlatform().name());&#10;            stmt.setBoolean(5, game.isAvailable());&#10;            stmt.setString(6, game.getType().name());&#10;            stmt.setDouble(7, game.getPrice());&#10;            stmt.executeUpdate();&#10;            return game;&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la sauvegarde du jeu : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;            return null;&#10;        }&#10;    }&#10;&#10;    public Game findById(String id) {&#10;        String sql = &quot;SELECT * FROM games WHERE id = ?&quot;;&#10;&#10;        try (PreparedStatement stmt = getConnection().prepareStatement(sql)) {&#10;            stmt.setString(1, id);&#10;            ResultSet rs = stmt.executeQuery();&#10;&#10;            if (rs.next()) {&#10;                Game game = GameFactory.create(&#10;                    rs.getString(&quot;id&quot;),&#10;                    rs.getString(&quot;title&quot;),&#10;                    rs.getString(&quot;genre&quot;),&#10;                    GamePlatform.valueOf(rs.getString(&quot;platform&quot;)),&#10;                    rs.getBoolean(&quot;is_available&quot;),&#10;                    fr.efrei.domain.GameType.valueOf(rs.getString(&quot;type&quot;)),&#10;                    rs.getDouble(&quot;price&quot;)&#10;                );&#10;                return game;&#10;            }&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la recherche du jeu : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;        }&#10;        return null;&#10;    }&#10;&#10;    public List&lt;Game&gt; findAll() {&#10;        List&lt;Game&gt; games = new ArrayList&lt;&gt;();&#10;        String sql = &quot;SELECT * FROM games&quot;;&#10;&#10;        try (Statement stmt = getConnection().createStatement();&#10;             ResultSet rs = stmt.executeQuery(sql)) {&#10;&#10;            while (rs.next()) {&#10;                Game game = GameFactory.create(&#10;                    rs.getString(&quot;id&quot;),&#10;                    rs.getString(&quot;title&quot;),&#10;                    rs.getString(&quot;genre&quot;),&#10;                    GamePlatform.valueOf(rs.getString(&quot;platform&quot;)),&#10;                    rs.getBoolean(&quot;is_available&quot;),&#10;                    fr.efrei.domain.GameType.valueOf(rs.getString(&quot;type&quot;)),&#10;                    rs.getDouble(&quot;price&quot;)&#10;                );&#10;                games.add(game);&#10;            }&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la récupération des jeux : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;        }&#10;        return games;&#10;    }&#10;&#10;    public List&lt;Game&gt; findAvailableByPlatform(GamePlatform platform) {&#10;        List&lt;Game&gt; games = new ArrayList&lt;&gt;();&#10;        String sql = &quot;SELECT * FROM games WHERE is_available = true&quot;;&#10;&#10;        try (Statement stmt = getConnection().createStatement();&#10;             ResultSet rs = stmt.executeQuery(sql)) {&#10;&#10;            while (rs.next()) {&#10;                GamePlatform gamePlatform = GamePlatform.valueOf(rs.getString(&quot;platform&quot;));&#10;                if (gamePlatform.isCompatibleWith(platform)) {&#10;                    Game game = GameFactory.create(&#10;                        rs.getString(&quot;id&quot;),&#10;                        rs.getString(&quot;title&quot;),&#10;                        rs.getString(&quot;genre&quot;),&#10;                        gamePlatform,&#10;                        rs.getBoolean(&quot;is_available&quot;),&#10;                        fr.efrei.domain.GameType.valueOf(rs.getString(&quot;type&quot;)),&#10;                        rs.getDouble(&quot;price&quot;)&#10;                    );&#10;                    games.add(game);&#10;                }&#10;            }&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la récupération des jeux : &quot; + e.getMessage());&#10;        }&#10;        return games;&#10;    }&#10;&#10;    public List&lt;Game&gt; findAvailableForSaleByPlatform(GamePlatform platform) {&#10;        String sql = &quot;SELECT * FROM games WHERE platform = ? AND is_available = TRUE AND type = 'SALE'&quot;;&#10;        List&lt;Game&gt; games = new ArrayList&lt;&gt;();&#10;        try (PreparedStatement stmt = getConnection().prepareStatement(sql)) {&#10;            stmt.setString(1, platform.name());&#10;            ResultSet rs = stmt.executeQuery();&#10;            while (rs.next()) {&#10;                Game game = GameFactory.create(&#10;                    rs.getString(&quot;id&quot;),&#10;                    rs.getString(&quot;title&quot;),&#10;                    rs.getString(&quot;genre&quot;),&#10;                    GamePlatform.valueOf(rs.getString(&quot;platform&quot;)),&#10;                    rs.getBoolean(&quot;is_available&quot;),&#10;                    fr.efrei.domain.GameType.valueOf(rs.getString(&quot;type&quot;)),&#10;                    rs.getDouble(&quot;price&quot;)&#10;                );&#10;                games.add(game);&#10;            }&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la récupération des jeux à vendre : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;        }&#10;        return games;&#10;    }&#10;&#10;    public boolean delete(String id) {&#10;        String sql = &quot;DELETE FROM games WHERE id = ?&quot;;&#10;&#10;        try (PreparedStatement stmt = getConnection().prepareStatement(sql)) {&#10;            stmt.setString(1, id);&#10;            return stmt.executeUpdate() &gt; 0;&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la suppression du jeu : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;            return false;&#10;        }&#10;    }&#10;&#10;    public boolean updateAvailability(String gameId, boolean available) {&#10;        String sql = &quot;UPDATE games SET is_available = ? WHERE id = ?&quot;;&#10;&#10;        try (PreparedStatement stmt = getConnection().prepareStatement(sql)) {&#10;            stmt.setBoolean(1, available);&#10;            stmt.setString(2, gameId);&#10;            return stmt.executeUpdate() &gt; 0;&#10;        } catch (SQLException e) {&#10;            System.err.println(&quot;Erreur lors de la mise à jour de la disponibilité : &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;            return false;&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>